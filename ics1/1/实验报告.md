# 实验报告

## calculate_1

思路：

1. 因为不会溢出范围，所以去掉get函数，直接按照数组下标方式读取。
2. 把多个循环合并到一起，方便操作。
3. 循环内部把重复计算的部分用临时变量存起来，减少一些重复的取值计算。
4. 把循环按照2*2的方式展开，实现优化。
5. 处理2*2可能会剩下的那个单独的值。
6. 最后再进行加总，然后计算出结果。

## calculate_2



思路：

1. 直接用`simd`指令集，对各个变量进行累加求和，最后再把各部分和累加，得到最终答案。

2. 中间使用了包括mask来作为判断date的条件，计数时由于mask=-1或0，直接用0-mask可以得到1的方式，来实现total的计数。

3. 选择的参数为：整数128，浮点数256，实现四路并行。

   原因：

   1. 最开始试图分开整数和浮点数的计算，都用256位来解决，但由于计算discount需要用到price，前后相关联，所以把浮点数和整数分开的方式不太可取。
   2. 随后改成128+256，这种模式下每次能够计算四个值，但过程中需要注意一下128位整数和256位浮点数之间的转换，略微麻烦。
   3. 在实现128和256之后，试图推广到256和512，但由于本地使用512位会报错，并且没找到一个解决的方式，跑不起来，所以选择放弃。最终选择128和256的四个计算同步执行。

